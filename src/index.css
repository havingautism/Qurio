@import 'tailwindcss';
@variant dark (&:where(.dark, .dark *));
@source "../node_modules/streamdown/dist/*.js";

/* CSS variables for sidebar width */
:root {
  --sidebar-width: 0px;
  --message-font-size: 16px;
}

/* ============================================
   DESIGN TOKENS - SPACING SYSTEM
   ============================================ */
:root {
  /* Spacing scale */
  --space-1: 4px;
  --space-2: 8px;
  --space-3: 12px;
  --space-4: 16px;
  --space-5: 20px;
  --space-6: 24px;
  --space-8: 32px;
  --space-10: 40px;
  --space-12: 48px;
  --space-16: 64px;
  --space-20: 80px;
  --space-24: 96px;
}

/* ============================================
   DESIGN TOKENS - BORDER RADIUS
   ============================================ */
:root {
  --radius-sm: 6px;
  --radius-md: 10px;
  --radius-lg: 16px;
  --radius-xl: 24px;
  --radius-2xl: 32px;
  --radius-full: 9999px;
}

/* ============================================
   DESIGN TOKENS - SHADOW SYSTEM
   ============================================ */
:root {
  --shadow-xs: 0 1px 2px rgba(0, 0, 0, 0.05);
  --shadow-sm: 0 1px 3px rgba(0, 0, 0, 0.1), 0 1px 2px rgba(0, 0, 0, 0.06);
  --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
  --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
  --shadow-xl: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
  --shadow-2xl: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
  --shadow-inner: inset 0 2px 4px rgba(0, 0, 0, 0.06);
  --shadow-glow: 0 0 20px var(--theme-glow-1), 0 0 40px var(--theme-glow-2);
}

/* ============================================
   DESIGN TOKENS - GLASS MORPHISM
   ============================================ */
:root {
  --glass-light: rgba(255, 255, 255, 0.7);
  --glass-dark: rgba(0, 0, 0, 0.3);
  --glass-border-light: rgba(255, 255, 255, 0.2);
  --glass-border-dark: rgba(255, 255, 255, 0.1);
}

/* ============================================
   DESIGN TOKENS - TYPOGRAPHY
   ============================================ */
:root {
  --font-size-xs: 12px;
  --font-size-sm: 14px;
  --font-size-base: 16px;
  --font-size-lg: 18px;
  --font-size-xl: 20px;
  --font-size-2xl: 24px;
  --font-size-3xl: 30px;
  --font-size-4xl: 36px;

  --line-height-tight: 1.25;
  --line-height-snug: 1.375;
  --line-height-normal: 1.5;
  --line-height-relaxed: 1.625;
  --line-height-loose: 2;

  --font-weight-normal: 400;
  --font-weight-medium: 500;
  --font-weight-semibold: 600;
  --font-weight-bold: 700;
}

/* ============================================
   DESIGN TOKENS - TRANSITIONS
   ============================================ */
:root {
  --transition-fast: 150ms cubic-bezier(0.4, 0, 0.2, 1);
  --transition-normal: 250ms cubic-bezier(0.4, 0, 0.2, 1);
  --transition-slow: 350ms cubic-bezier(0.4, 0, 0.2, 1);
  --transition-spring: 500ms cubic-bezier(0.34, 1.56, 0.64, 1);
}

/* ============================================
   UTILITY CLASSES
   ============================================ */
.transition-base {
  transition: all var(--transition-normal);
}

.transition-fast {
  transition: all var(--transition-fast);
}

.transition-slow {
  transition: all var(--transition-slow);
}

/* Glass morphism utilities */
.glass {
  background: var(--glass-light);
  backdrop-filter: blur(12px);
  -webkit-backdrop-filter: blur(12px);
  border: 1px solid var(--glass-border-light);
}

.dark .glass {
  background: var(--glass-dark);
  border-color: var(--glass-border-dark);
}

/* Premium card effects */
.premium-card {
  @apply bg-white/60 dark:bg-zinc-900/60 backdrop-blur-xl border border-gray-200/50 dark:border-zinc-700/50 shadow-sm;
  border-radius: var(--radius-lg);
}

.premium-card-hover {
  @apply transition-all duration-300 hover:shadow-lg hover:scale-[1.02] hover:border-primary-500/30;
}

/* Focus ring utility */
.focus-ring {
  @apply focus:outline-none focus-visible:ring-2 focus-visible:ring-primary-500 focus-visible:ring-offset-2 dark:focus-visible:ring-offset-gray-900;
}

/* Smooth transitions for interactive elements */
.interactive {
  @apply transition-all duration-200 ease-out;
}

.interactive-scale {
  @apply transition-transform duration-200 ease-out hover:scale-105 active:scale-95;
}

/* Gradient text */
.gradient-text {
  @apply bg-gradient-to-r from-primary-500 to-primary-600 bg-clip-text text-transparent;
}

/* Apply transform to elements that need to move with sidebar */
.sidebar-shift {
  transform: translateX(calc(-1 * var(--sidebar-width)));
  /* transform: translateX(calc(-1 * 80%)); */
  transition: transform 0.3s ease-in-out;
}

@theme {
  --color-background: var(--background);
  --color-foreground: var(--foreground);
  --color-sidebar: var(--sidebar);
  --color-sidebar-foreground: var(--sidebar-foreground);
  --color-user-bubble: var(--user-bubble);
  --font-sans:
    var(--font-google-sans-flex), var(--font-google-sans), var(--font-noto-sans-sc), system-ui,
    -apple-system, 'Segoe UI', Roboto, 'PingFang SC', 'Hiragino Sans', 'Microsoft YaHei', sans-serif;

  --font-sans-serif:
    var(--font-google-sans-flex), var(--font-google-sans), var(--font-noto-sans-sc), system-ui,
    -apple-system, 'Segoe UI', 'PingFang SC', 'Hiragino Sans', 'Microsoft YaHei', sans-serif;

  /* 代码 / Prompt / Log */
  --font-mono:
    var(--font-google-sans-mono), ui-monospace, SFMono-Regular, 'SF Mono', 'Cascadia Code',
    'Segoe UI Mono', 'Source Code Pro', Menlo, Consolas, monospace;

  --font-code:
    var(--font-google-sans-code), ui-monospace, SFMono-Regular, 'SF Mono', 'Cascadia Code',
    'Segoe UI Mono', 'Source Code Pro', Menlo, Consolas, monospace;

  /* Custom Primary Palette (formerly Brown) - Default Map to Variables */
  /* These will be overridden by the JS style injection on root */
  --color-primary-50: var(--color-primary-50);
  --color-primary-100: var(--color-primary-100);
  --color-primary-200: var(--color-primary-200);
  --color-primary-300: var(--color-primary-300);
  --color-primary-400: var(--color-primary-400);
  --color-primary-500: var(--color-primary-500);
  --color-primary-600: var(--color-primary-600);
  --color-primary-700: var(--color-primary-700);
  --color-primary-800: var(--color-primary-800);
  --color-primary-900: var(--color-primary-900);
  --color-primary-950: var(--color-primary-950);

  --animate-slide-up: slide-up 0.3s cubic-bezier(0.16, 1, 0.3, 1);
  --animate-shake: shake 0.5s ease-in-out infinite;

  @keyframes slide-up {
    from {
      transform: translateY(100%);
    }
    to {
      transform: translateY(0);
    }
  }

  @keyframes shine {
    0% {
      left: -100%;
      opacity: 0;
    }
    20% {
      opacity: 0.5;
    }
    40% {
      left: 100%;
      opacity: 0;
    }
    100% {
      left: 100%;
      opacity: 0;
    }
  }

  @keyframes shake {
    0%,
    100% {
      transform: rotate(0deg);
    }
    25% {
      transform: rotate(-4deg);
    }
    75% {
      transform: rotate(4deg);
    }
  }

  @keyframes pulse-glow {
    0%,
    100% {
      box-shadow:
        0 0 20px var(--theme-glow-1),
        0 0 40px var(--theme-glow-2);
    }
    50% {
      box-shadow:
        0 0 30px var(--theme-glow-1),
        0 0 60px var(--theme-glow-2);
    }
  }

  @keyframes float {
    0%,
    100% {
      transform: translateY(0);
    }
    50% {
      transform: translateY(-10px);
    }
  }

  @keyframes shimmer {
    0% {
      background-position: -200% 0;
    }
    100% {
      background-position: 200% 0;
    }
  }
}

:root {
  /* Default Theme (Fox Rust) Initial Values */
  --color-primary-50: #fcf9f7;
  --color-primary-100: #f6ece8;
  --color-primary-200: #edd4cc;
  --color-primary-300: #e0b4a6;
  --color-primary-400: #d0907c;
  --color-primary-500: #bf6e4e;
  --color-primary-600: #a65234;
  --color-primary-700: #8a4028;
  --color-primary-800: #703322;
  --color-primary-900: #592b1e;
  --color-primary-950: #33160f;

  /* Dynamic background variables injected by src/lib/themes.js */
  --background: #f9f9f9;
  --foreground: #44403c;
  /* gray-800 -> stone-800 - lighter for softer light mode text */
  --sidebar: #f9f9f9;
  /* stone-200 */
  --sidebar-foreground: #78716c;
  /* stone-600 - lighter for softer light mode text */
  --border: #e7e5e4;
  /* stone-200 - lighter border */

  --user-bubble: #f7f2f1;

  --font-google-sans-flex: 'Google Sans Flex';
  --font-google-sans: 'Google Sans';
  --font-google-sans-mono: 'Google Sans Mono';
  --font-google-sans-code: 'Google Sans Code';
  --font-noto-sans-sc: 'Noto Sans SC';

  /* Glow defaults (Fox Rust) - Lighter for light mode */
  --theme-glow-1: rgba(245, 220, 210, 0.5);
  --theme-glow-2: rgba(235, 190, 170, 0.4);
  --theme-glow-3: rgba(210, 144, 124, 0.35);
}

.dark {
  /* Dynamic background variables injected by src/lib/themes.js */
  --background: var(--theme-bg-dark, #1c1917);
  --foreground: #e5e7eb;
  /* stone-950 */
  --sidebar: var(--theme-sidebar-dark, #1c1917);
  /* stone-900 */
  --sidebar-foreground: #a8a29e;
  /* stone-400 */
  --border: #292524;
  /* stone-800 */
}

body {
  @apply bg-background text-foreground font-sans antialiased overflow-x-hidden;
}

body.scroll-locked {
  overflow: hidden;
  height: 100%;
}

button {
  cursor: pointer;
}

h1,
h2,
h3,
h4,
h5,
h6 {
  @apply font-sans-serif;
}

.prose h1,
.prose h2,
.prose h3,
.prose h4,
.prose h5,
.prose h6 {
  font-family: var(--font-sans-serif);
}

.prose {
  font-family: var(--font-sans);
}

.prose code,
.message-content code {
  font-family: var(--font-google-sans-code);
}

.prose pre,
.message-content pre,
.prose pre code,
.message-content pre code {
  font-family: var(--font-google-sans-code);
  line-height: 1.65 !important;
}

.prose pre,
.message-content pre {
  padding: 1rem !important;
  border-radius: var(--radius-md) !important;
  font-size: 0.9em !important;
}

/* List items in AI responses */
.message-content ul,
.message-content ol {
  line-height: 1.75 !important;
  margin-bottom: 0.85em !important;
}

.message-content li {
  margin-bottom: 0.4em !important;
}

/* Blockquotes for citations */
.message-content blockquote {
  border-left: 3px solid var(--color-primary-500) !important;
  padding-left: 1rem !important;
  margin: 1em 0 !important;
  font-style: italic !important;
  /* color: var(--color-primary-700) !important; */
}

/* .dark .message-content blockquote {
  /* color: var(--color-primary-300) !important; */
/* } */

.message-content {
  font-size: var(--message-font-size) !important;
  line-height: 1.7 !important;
}

.message-content p {
  font-size: var(--message-font-size) !important;
  line-height: 1.75 !important;
  /* margin-bottom: 0.85em !important; */
}

/* .message-content p:last-child {
  margin-bottom: 1em !important;
} */

/* Custom Scrollbar for Tables - Horizontal always visible */
.table-scrollbar::-webkit-scrollbar {
  height: 6px;
  width: 6px;
}

.table-scrollbar::-webkit-scrollbar-track {
  background: transparent;
}

.table-scrollbar::-webkit-scrollbar-thumb {
  background-color: #e5e5e5;
  border-radius: 3px;
}

.dark .table-scrollbar::-webkit-scrollbar-thumb {
  background-color: #3d3d3d;
}

.table-scrollbar::-webkit-scrollbar-thumb:hover {
  background-color: #d4d4d4;
}

.dark .table-scrollbar::-webkit-scrollbar-thumb:hover {
  background-color: #525252;
}

/* Vertical scrollbar auto-hide for tables */
.table-scrollbar::-webkit-scrollbar:not(:hover):not(:focus-within)::-webkit-scrollbar-thumb {
  background-color: transparent;
}

/* Custom Scrollbar for Code Blocks - Horizontal always visible */
.code-scrollbar {
  overflow-x: auto !important;
  overflow-y: hidden !important;
  max-width: 100%;
  -webkit-overflow-scrolling: touch;
}

.code-scrollbar::-webkit-scrollbar {
  height: 6px;
  width: 6px;
}

.code-scrollbar::-webkit-scrollbar-track {
  background: transparent;
}

.code-scrollbar::-webkit-scrollbar-thumb {
  background-color: #e5e5e5;
  border-radius: 3px;
}

.dark .code-scrollbar::-webkit-scrollbar-thumb {
  background-color: #3d3d3d;
}

.code-scrollbar::-webkit-scrollbar-thumb:hover {
  background-color: #d4d4d4;
}

.dark .code-scrollbar::-webkit-scrollbar-thumb:hover {
  background-color: #525252;
}

@media (max-width: 640px) {
  .code-scrollbar::-webkit-scrollbar,
  .table-scrollbar::-webkit-scrollbar {
    height: 4px;
  }

  .code-scrollbar::-webkit-scrollbar-thumb,
  .table-scrollbar::-webkit-scrollbar-thumb {
    border-radius: 999px;
  }

  .code-scrollbar::-webkit-scrollbar-track,
  .table-scrollbar::-webkit-scrollbar-track {
    background: transparent;
  }
}

/* Custom Scrollbar for Sidebar - Vertical auto-hide */
.sidebar-scrollbar {
  scrollbar-width: thin;
  scrollbar-color: transparent transparent;
}

.dark .sidebar-scrollbar {
  scrollbar-color: transparent transparent;
}

.sidebar-scrollbar::-webkit-scrollbar {
  height: 3px;
  width: 3px;
}

.sidebar-scrollbar::-webkit-scrollbar-track {
  background: transparent;
}

.sidebar-scrollbar::-webkit-scrollbar-thumb {
  background-color: transparent;
  border-radius: 3px;
  transition: background-color 0.2s ease;
}

.sidebar-scrollbar:hover::-webkit-scrollbar-thumb {
  background-color: #e5e5e5;
}

.dark .sidebar-scrollbar:hover::-webkit-scrollbar-thumb {
  background-color: #3d3d3d;
}

.sidebar-scrollbar::-webkit-scrollbar-thumb:hover {
  background-color: #d4d4d4;
}

.dark .sidebar-scrollbar::-webkit-scrollbar-thumb:hover {
  background-color: #525252;
}

/* Robust Monospace Font Stack for Code Blocks and Diagrams */
.font-code-robust {
  font-family:
    ui-monospace, SFMono-Regular, Consolas, 'Liberation Mono', Menlo, Courier, monospace,
    'PingFang SC', 'Microsoft YaHei' !important;
}

/* Shared glow for primary input shells (home + chat) */
.input-glow-veil {
  background: linear-gradient(
    125deg,
    var(--theme-glow-1),
    var(--theme-glow-2) 50%,
    var(--theme-glow-3)
  );
}

/* Custom Scrollbar for Messages Container - Vertical auto-hide */
.messages-scrollbar {
  scrollbar-width: thin;
  scrollbar-color: transparent transparent;
  -webkit-overflow-scrolling: touch;
  height: 100%;
}

.dark .messages-scrollbar {
  scrollbar-color: transparent transparent;
}

.messages-scrollbar::-webkit-scrollbar {
  width: 6px;
}

.messages-scrollbar::-webkit-scrollbar-track {
  background: transparent;
}

.messages-scrollbar::-webkit-scrollbar-thumb {
  background-color: transparent;
  border-radius: 3px;
  transition: background-color 0.2s ease;
}

.messages-scrollbar:hover::-webkit-scrollbar-thumb {
  background-color: #e5e5e5;
}

.dark .messages-scrollbar:hover::-webkit-scrollbar-thumb {
  background-color: #3d3d3d;
}

.messages-scrollbar::-webkit-scrollbar-thumb:hover {
  background-color: #d4d4d4;
}

.dark .messages-scrollbar::-webkit-scrollbar-thumb:hover {
  background-color: #525252;
}

/* Custom Easing */
.ease-spring {
  transition-timing-function: cubic-bezier(0.175, 0.885, 0.32, 1.275);
}

/* Global Scrollbar Defaults - Vertical auto-hide, Horizontal always visible */
::-webkit-scrollbar {
  width: 6px;
  height: 6px;
}

::-webkit-scrollbar-track {
  background: transparent;
}

::-webkit-scrollbar-thumb {
  background-color: transparent;
  border-radius: 3px;
  transition: background-color 0.2s ease;
}

::-webkit-scrollbar-thumb:hover {
  background-color: #d4d4d4;
}

.dark ::-webkit-scrollbar-thumb:hover {
  background-color: #525252;
}

/* Vertical scrollbar - auto-hide */
::-webkit-scrollbar:not(:hover):not(:focus-within) {
  width: 4px;
}

::-webkit-scrollbar:not(:hover):not(:focus-within)::-webkit-scrollbar-thumb {
  background-color: transparent;
}

/* Horizontal scrollbar - always visible but subtle */
::-webkit-scrollbar-horizontal {
  height: 6px !important;
}

::-webkit-scrollbar-horizontal::-webkit-scrollbar-thumb {
  background-color: #e5e5e5;
  opacity: 0.8;
  transition: opacity 0.2s ease;
}

.dark ::-webkit-scrollbar-horizontal::-webkit-scrollbar-thumb {
  background-color: #3d3d3d;
}

::-webkit-scrollbar-horizontal::-webkit-scrollbar-thumb:hover {
  opacity: 1;
}

/* Utility to hide scrollbar but allow scrolling */
.no-scrollbar {
  -ms-overflow-style: none; /* IE and Edge */
  scrollbar-width: none; /* Firefox */
}
.no-scrollbar::-webkit-scrollbar {
  display: none;
}

/* Modal scrollbar - prevents rounded corner obstruction */
.modal-scrollbar {
  scrollbar-width: thin;
  scrollbar-color: transparent transparent;
  overflow-x: hidden;
}

.modal-scrollbar::-webkit-scrollbar {
  width: 6px;
  height: 6px;
}

.modal-scrollbar::-webkit-scrollbar-track {
  background: transparent;
  margin-right: 2px;
}

.modal-scrollbar::-webkit-scrollbar-thumb {
  background-color: transparent;
  border-radius: 3px;
  transition: background-color 0.2s ease;
}

.modal-scrollbar:hover::-webkit-scrollbar-thumb {
  background-color: #d6d3d1;
}

.dark .modal-scrollbar:hover::-webkit-scrollbar-thumb {
  background-color: #44403c;
}

.modal-scrollbar::-webkit-scrollbar-thumb:hover {
  background-color: #a8a29e;
}

.dark .modal-scrollbar::-webkit-scrollbar-thumb:hover {
  background-color: #57534e;
}

/* Ensure modal content has proper padding so scrollbar isn't obscured by rounded corners */
.modal-scrollbar-content {
  padding-right: 8px;
  padding-left: 4px;
  margin-right: -4px;
  margin-left: -4px;
}

@keyframes blob-float {
  0% {
    transform: translate(0, 0) scale(1);
  }
  33% {
    transform: translate(-30px, 30px) scale(1.1);
  }
  66% {
    transform: translate(30px, -20px) scale(0.9);
  }
  100% {
    transform: translate(0, 0) scale(1);
  }
}

@keyframes blob-float-alt {
  0% {
    transform: translate(0, 0) scale(1);
  }
  33% {
    transform: translate(40px, -40px) scale(1.2);
  }
  66% {
    transform: translate(-20px, 30px) scale(0.8);
  }
  100% {
    transform: translate(0, 0) scale(1);
  }
}

@keyframes twinkle {
  0%,
  100% {
    opacity: 0.2;
    transform: scale(0.8);
  }
  50% {
    opacity: 1;
    transform: scale(1.2);
  }
}

@keyframes diagonal-shine {
  0% {
    top: 120%;
    left: -120%;
  }
  50%,
  100% {
    top: -120%;
    left: 120%;
  }
}

.animate-blob-float {
  animation: blob-float 15s ease-in-out infinite;
}

.animate-blob-float-alt {
  animation: blob-float-alt 18s ease-in-out infinite;
}

.animate-twinkle {
  animation: twinkle var(--duration, 3s) ease-in-out infinite;
}

.animate-diagonal-shine {
  animation: diagonal-shine 8s ease-in-out infinite;
}

/* Premium Card Effects */
.premium-card-bg {
  @apply bg-white/40 dark:bg-zinc-900/40 backdrop-blur-md border border-gray-200/50 dark:border-zinc-700/50 shadow-xs;
}

.premium-card-glow {
  box-shadow: 0 0 15px -3px var(--theme-glow-1);
}

.shine-effect {
  position: relative;
  overflow: hidden;
}

.shine-effect::after {
  content: '';
  position: absolute;
  top: 0;
  left: -100%;
  width: 50%;
  height: 100%;
  background: linear-gradient(
    to right,
    transparent,
    rgba(255, 255, 255, 0.1) 20%,
    rgba(255, 255, 255, 0.2) 50%,
    rgba(255, 255, 255, 0.1) 80%,
    transparent
  );
  transform: skewX(-25deg);
  animation: shine 6s infinite;
  pointer-events: none;
}

.dark .shine-effect::after {
  background: linear-gradient(
    to right,
    transparent,
    rgba(255, 255, 255, 0.03) 20%,
    rgba(255, 255, 255, 0.08) 50%,
    rgba(255, 255, 255, 0.03) 80%,
    transparent
  );
}
