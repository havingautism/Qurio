from pathlib import Path
path = Path('src/components/chat/ChatInputBar.jsx')
text = path.read_text(encoding='utf-8')
start = text.index('const CapsuleSettingsMenu = React.memo(')
end = text.index("CapsuleSettingsMenu.displayName")
replacement = "const CapsuleSettingsMenu = React.memo(\n  ({\n    agents,\n    isAgentAutoMode,\n    onAgentAutoModeToggle,\n    onAgentSelect,\n    selectedAgent,\n    spacePrimaryAgentId,\n    isThinkingLocked,\n    isThinkingActive,\n    onToggleThinking,\n    isSearchActive,\n    onToggleSearch,\n    selectedSearchTool,\n    searchOptions = [],\n    t,\n    isSearchSupported,\n  }) => {\n    const activeSearchLabel = React.useMemo(() => {\n      if (!selectedSearchTool) return t('homeView.search')\n      const option = (searchOptions || []).find(item => item.id === selectedSearchTool)\n      return option ? t(option.labelKey) : t('homeView.search')\n    }, [selectedSearchTool, searchOptions, t])\n\n    return (\n      <div className=\"space-y-3\">\n        {/* Models List */}\n        <div>\n          <div className=\"text-[10px] font-bold text-gray-400 uppercase tracking-widest px-2 mb-2\">\n            {t('chatInterface.agentsLabel')}\n          </div>\n          <div className=\"flex flex-col gap-1.5 max-h-[300px] overflow-y-auto no-scrollbar\">\n            <button\n              onClick={() => onAgentAutoModeToggle()}\n              className={clsx(\n                'flex items-center justify-between w-full px-3 py-2 rounded-xl text-sm transition-colors',\n                isAgentAutoMode\n                  ? 'bg-gray-100 dark:bg-zinc-700/50 text-gray-900 dark:text-white font-medium'\n                  : 'hover:bg-gray-100 dark:hover:bg-zinc-700/50 text-gray-600 dark:text-gray-300',\n              )}\n            >\n              <div className=\"flex items-center gap-2.5\">\n                <span className=\"text-lg\">✨</span>\n                <span>{t('chatInterface.agentAuto')}</span>\n              </div>\n              {isAgentAutoMode && <Check size={14} className=\"text-primary-500\" />}\n            </button>\n            {agents.map(agent => {\n              const isSelected = !isAgentAutoMode && selectedAgent?.id === agent.id\n              const isDefault = agent.isDefault || String(agent.id) === String(spacePrimaryAgentId)\n              return (\n                <button\n                  key={agent.id}\n                  onClick={() => onAgentSelect(agent)}\n                  className={clsx(\n                    'flex items-center justify-between w-full px-3 py-2 rounded-xl text-sm transition-colors',\n                    isSelected\n                      ? 'bg-gray-100 dark:bg-zinc-700/50 text-gray-900 dark:text-white font-medium'\n                      : 'hover:bg-gray-100 dark:hover:bg-zinc-700/50 text-gray-600 dark:text-gray-300',\n                  )}\n                >\n                  <div className=\"flex items-center gap-2.5\">\n                    <EmojiDisplay emoji={agent.emoji} size=\"1.1em\" />\n                    <span className=\"truncate\">{getAgentDisplayName(agent, t)}</span>\n                    {isDefault && (\n                      <span className=\"text-[10px] px-1.5 py-0.5 bg-primary-100 dark:bg-primary-900/30 text-primary-600 dark:text-primary-400 rounded-md font-medium\">\n                        {t('chatInterface.default')}\n                      </span>\n                    )}\n                  </div>\n                  {isSelected && <Check size={14} className=\"text-primary-500\" />}\n                </button>\n              )\n            })}\n          </div>\n        </div>\n\n        <div className=\"h-px bg-gray-100 dark:bg-zinc-700/50\" />\n\n        {/* Capabilities */}\n        <div>\n          <div className=\"text-[10px] font-bold text-gray-400 uppercase tracking-widest px-2 mb-2\">\n            {t('chatInterface.capabilities')}\n          </div>\n          <div className=\"space-y-0.5\">\n            <button\n              disabled={isThinkingLocked}\n              onClick={onToggleThinking}\n              className=\"flex items-center justify-between w-full px-3 py-2 rounded-xl text-sm hover:bg-gray-100 dark:hover:bg-zinc-700/50 transition-colors\"\n            >\n              <div className=\"flex items-center gap-2.5 text-gray-700 dark:text-gray-200\">\n                <Brain\n                  size={16}\n                  className={isThinkingActive ? 'text-primary-500' : 'text-gray-400'}\n                />\n                <span>{t('homeView.think')}</span>\n              </div>\n              <div\n                className={clsx(\n                  'w-8 h-4 rounded-full relative transition-colors',\n                  isThinkingActive ? 'bg-primary-500' : 'bg-gray-200 dark:bg-zinc-600',\n                )}\n              >\n                <div\n                  className={clsx(\n                    'absolute top-0.5 w-3 h-3 bg-white rounded-full transition-all shadow-sm',\n                    isThinkingActive ? 'left-4.5' : 'left-0.5',\n                  )}\n                />\n              </div>\n            </button>\n            <div className=\"relative\">\n              <button\n                disabled={!isSearchSupported}\n                onClick={onToggleSearch}\n                className={clsx(\n                  'flex items-center justify-between w-full px-3 py-2 rounded-xl text-sm hover:bg-gray-100 dark:hover:bg-zinc-700/50 transition-colors disabled:opacity-50',\n                  isSearchActive\n                    ? 'text-primary-500 bg-primary-50 dark:bg-primary-900/20'\n                    : 'text-gray-500 dark:text-gray-400',\n                )}\n              >\n                <div className=\"flex items-center gap-2.5 text-gray-700 dark:text-gray-200\">\n                  <Globe size={16} className={isSearchActive ? 'text-primary-500' : 'text-gray-400'} />\n                  <span>{activeSearchLabel}</span>\n                </div>\n                <div\n                  className={clsx(\n                    'w-8 h-4 rounded-full relative transition-colors',\n                    isSearchActive ? 'bg-primary-500' : 'bg-gray-200 dark:bg-zinc-600',\n                  )}\n                >\n                  <div\n                    className={clsx(\n                      'absolute top-0.5 w-3 h-3 bg-white rounded-full transition-all shadow-sm',\n                      isSearchActive ? 'left-4.5' : 'left-0.5',\n                    )}\n                  />\n                </div>\n              </button>\n              {isSearchMenuOpen && (\n                <div\n                  ref={searchMenuRef}\n                  className=\"absolute bottom-full left-0 mb-2 w-48 bg-white dark:bg-zinc-900 border border-gray-200 dark:border-zinc-700 rounded-2xl shadow-2xl z-30 overflow-hidden\"\n                >\n                  <div className=\"px-4 py-2 text-[10px] uppercase tracking-wide text-gray-500 dark:text-zinc-400\">\n                    {t('chatInterface.searchMenuTitle')}\n                  </div>\n                  <div className=\"flex flex-col divide-y divide-gray-100 dark:divide-zinc-800\">\n                    {searchOptions.map(option => {\n                      const isActive = selectedSearchTool === option.id\n                      return (\n                        <button\n                          key={option.id}\n                          type=\"button\"\n                          onClick={() => onSearchToolSelect?.(option.id)}\n                          className={clsx(\n                            'w-full px-4 py-2.5 text-left text-sm flex items-center justify-between transition-colors hover:bg-gray-100 dark:hover:bg-zinc-800',\n                            isActive\n                              ? 'bg-primary-50 dark:bg-primary-900/20 text-primary-600 dark:text-primary-400'\n                              : 'text-gray-700 dark:text-gray-200',\n                          )}\n                        >\n                          <span>{t(option.labelKey)}</span>\n                          {isActive && <Check size={14} className=\"text-primary-500\" />}\n                        </button>\n                      )\n                    })}\n                  </div>\n                  <div className=\"border-t border-gray-100 dark:border-zinc-800\">\n                    <button\n                      type=\"button\"\n                      onClick={() => onSearchToolSelect?.(null)}\n                      className=\"w-full px-4 py-2.5 text-left text-sm text-gray-500 dark:text-gray-400 flex items-center justify-between hover:bg-gray-100 dark:hover:bg-zinc-800 transition-colors\"\n                    >\n                      <span>{t('common.off')}</span>\n                    </button>\n                  </div>\n                </div>\n              )}\n            </div>\n          </div>\n        </div>\n      </div>\n    )\n  },\n)
"
new_text = text[:start] + replacement + text[end:]
path.write_text(new_text, encoding='utf-8')
